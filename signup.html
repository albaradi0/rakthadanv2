<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Sign Up ‚Äî ‡¶∞‡¶ï‡ßç‡¶§‡¶¶‡¶æ‡¶®</title>
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet"/>
<style>
  :root { --red:#C0152A; --red-dark:#8B0E1E; --cream:#FDF6EE; --ink:#1A0A0D; --muted:#7A6068; --border:#EDE0D8; }
  * { margin:0; padding:0; box-sizing:border-box; }
  body { font-family:'DM Sans',sans-serif; background:var(--cream); color:var(--ink); min-height:100vh; display:flex; flex-direction:column; }
  nav { background:var(--red); padding:0 2rem; display:flex; align-items:center; justify-content:space-between; height:64px; }
  .nav-logo { font-family:'Playfair Display',serif; color:#fff; font-size:1.5rem; font-weight:900; text-decoration:none; }
  .nav-logo span { color:#FFB3BC; }

  .page { flex:1; display:grid; grid-template-columns:1fr 1fr; min-height:calc(100vh - 64px); }

  .left-panel {
    background: linear-gradient(160deg, var(--red-dark), var(--red));
    padding:3rem; display:flex; flex-direction:column; justify-content:center;
    position:relative; overflow:hidden;
  }
  .left-panel::after {
    content:'ü©∏'; font-size:20rem; position:absolute; right:-3rem; bottom:-3rem; opacity:.08; line-height:1;
  }
  .left-panel h2 { font-family:'Playfair Display',serif; color:#fff; font-size:2.2rem; line-height:1.2; margin-bottom:1.5rem; }
  .left-panel p { color:rgba(255,255,255,0.8); font-size:1rem; line-height:1.7; max-width:380px; }
  .perks { margin-top:2rem; display:flex; flex-direction:column; gap:1rem; }
  .perk { display:flex; align-items:center; gap:.75rem; color:rgba(255,255,255,0.9); font-size:.9rem; }
  .perk-icon { width:36px; height:36px; background:rgba(255,255,255,0.15); border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1rem; flex-shrink:0; }

  .form-panel { padding:3rem 2.5rem; display:flex; flex-direction:column; justify-content:center; max-width:500px; margin:0 auto; width:100%; }
  h1 { font-family:'Playfair Display',serif; font-size:1.9rem; font-weight:900; margin-bottom:.5rem; }
  .subtitle { color:var(--muted); font-size:.9rem; margin-bottom:2rem; }
  .subtitle a { color:var(--red); text-decoration:none; font-weight:600; }

  .form-group { margin-bottom:1rem; }
  label { display:block; font-size:.78rem; font-weight:600; color:var(--muted); text-transform:uppercase; letter-spacing:.5px; margin-bottom:.4rem; }
  input, select { width:100%; padding:.75rem 1rem; border:1.5px solid var(--border); border-radius:8px; font-family:'DM Sans',sans-serif; font-size:.9rem; color:var(--ink); background:#fff; outline:none; transition:.2s; }
  input:focus, select:focus { border-color:var(--red); box-shadow:0 0 0 3px rgba(192,21,42,0.1); }
  .input-row { display:grid; grid-template-columns:1fr 1fr; gap:.75rem; }

  .btn-submit { width:100%; padding:.85rem; background:var(--red); color:#fff; border:none; border-radius:8px; font-family:'DM Sans',sans-serif; font-size:1rem; font-weight:700; cursor:pointer; transition:.2s; margin-top:.5rem; }
  .btn-submit:hover { background:var(--red-dark); transform:translateY(-1px); box-shadow:0 6px 20px rgba(192,21,42,0.25); }

  .terms { font-size:.78rem; color:var(--muted); text-align:center; margin-top:1.5rem; line-height:1.5; }
  .terms a { color:var(--red); text-decoration:none; }

  .error-msg { background:#FEE2E2; color:#B91C1C; padding:.6rem 1rem; border-radius:6px; font-size:.82rem; margin-bottom:.75rem; display:none; }
  .error-msg.show { display:block; }
  .success-msg { background:#DCFCE7; color:#166534; padding:.6rem 1rem; border-radius:6px; font-size:.82rem; margin-bottom:.75rem; display:none; }
  .success-msg.show { display:block; }

  @media(max-width:768px) {
    .page { grid-template-columns:1fr; }
    .left-panel { display:none; }
    .form-panel { padding:2rem 1.5rem; }
    .input-row { grid-template-columns:1fr; }
  }
</style>
</head>
<body>
<nav>
  <a class="nav-logo" href="index.html">‡¶∞‡¶ï‡ßç‡¶§<span>‡¶¶‡¶æ‡¶®</span></a>
  <a href="index.html" style="color:rgba(255,255,255,0.8);text-decoration:none;font-size:.875rem;font-weight:500;">‚Üê Find Donors</a>
</nav>

<div class="page">
  <div class="left-panel">
    <h2>Join Bangladesh's Blood Donor Network</h2>
    <p>Register as a donor and help save lives in your community. Your profile will be visible to anyone in need.</p>
    <div class="perks">
      <div class="perk"><div class="perk-icon">‚úÖ</div>Free to join, always</div>
      <div class="perk"><div class="perk-icon">üìç</div>Searchable by your area</div>
      <div class="perk"><div class="perk-icon">ü©∏</div>Control your availability anytime</div>
    </div>
  </div>

  <div class="form-panel">
    <h1>Create Account</h1>
    <p class="subtitle">Already have one? <a href="login.html">Sign in here</a></p>

    <div id="errorMsg" class="error-msg"></div>
    <div id="successMsg" class="success-msg"></div>

    <!-- EMAIL SIGNUP FORM -->
    <div class="input-row">
      <div class="form-group">
        <label>First Name</label>
        <input type="text" id="firstName" placeholder="Rahim"/>
      </div>
      <div class="form-group">
        <label>Last Name</label>
        <input type="text" id="lastName" placeholder="Ahmed"/>
      </div>
    </div>
    <div class="form-group">
      <label>Email Address</label>
      <input type="email" id="emailInput" placeholder="you@example.com"/>
    </div>
    <div class="form-group">
      <label>Password</label>
      <input type="password" id="passwordInput" placeholder="Min. 8 characters"/>
    </div>
    <div class="input-row">
      <div class="form-group">
        <label>Blood Group</label>
        <select id="bloodGroup">
          <option value="">Select‚Ä¶</option>
          <option>A+</option><option>A-</option><option>B+</option><option>B-</option>
          <option>AB+</option><option>AB-</option><option>O+</option><option>O-</option>
        </select>
      </div>
      <div class="form-group">
        <label>Gender</label>
        <select id="gender">
          <option value="">Select‚Ä¶</option>
          <option>Male</option><option>Female</option><option>Other</option>
        </select>
      </div>
    </div>
    <div class="input-row">
      <div class="form-group">
        <label>Age</label>
        <input type="number" id="age" placeholder="e.g. 25" min="18" max="60"/>
      </div>
      <div class="form-group">
        <label>Division</label>
        <select id="division" onchange="loadDistricts(this.value,'districtSel')">
          <option value="">Select‚Ä¶</option>
          <option>Dhaka</option><option>Chattogram</option><option>Rajshahi</option>
          <option>Khulna</option><option>Barishal</option><option>Sylhet</option>
          <option>Rangpur</option><option>Mymensingh</option>
        </select>
      </div>
    </div>
    <div class="input-row">
      <div class="form-group">
        <label>District</label>
        <select id="districtSel"><option value="">Select division first</option></select>
      </div>
      <div class="form-group">
        <label>City / Upazila</label>
        <input type="text" id="cityInput" placeholder="e.g. Mirpur"/>
      </div>
    </div>
    <button class="btn-submit" onclick="signUpEmail()">Create Account ‚Üí</button>

    <p class="terms">By signing up you agree to our <a href="#">Terms of Service</a> and <a href="#">Privacy Policy</a></p>
  </div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword, sendEmailVerification } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
  import { getFirestore, doc, setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

  // üîß REPLACE WITH YOUR CONFIG
  const firebaseConfig = {
    apiKey: "AIzaSyBDiiieqfwoN1bmrYwbaF9UpWCqAZhGAB8",
    authDomain: "blood-donate-89909.firebaseapp.com",
    projectId: "blood-donate-89909",
    storageBucket: "blood-donate-89909.firebasestorage.app",
    messagingSenderId: "102069228183",
    appId: "1:102069228183:web:aa36468420d2d436620fd2"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  const districts = {
    Dhaka:["Dhaka","Gazipur","Narayanganj","Narsingdi","Manikganj","Munshiganj","Rajbari","Faridpur","Madaripur","Shariatpur","Gopalganj","Kishoreganj","Tangail"],
    Chattogram:["Chattogram","Cox's Bazar","Rangamati","Bandarban","Khagrachhari","Feni","Noakhali","Lakshmipur","Comilla","Chandpur","Brahmanbaria"],
    Rajshahi:["Rajshahi","Natore","Sirajganj","Pabna","Bogura","Joypurhat","Naogaon","Chapainawabganj"],
    Khulna:["Khulna","Bagerhat","Satkhira","Jessore","Narail","Magura","Jhenaidah","Chuadanga","Meherpur","Kushtia"],
    Barishal:["Barishal","Bhola","Patuakhali","Barguna","Pirojpur","Jhalokati"],
    Sylhet:["Sylhet","Moulvibazar","Habiganj","Sunamganj"],
    Rangpur:["Rangpur","Dinajpur","Thakurgaon","Panchagarh","Nilphamari","Lalmonirhat","Kurigram","Gaibandha"],
    Mymensingh:["Mymensingh","Netrokona","Kishoreganj","Jamalpur","Sherpur"]
  };

  window.loadDistricts = (div, targetId) => {
    const sel = document.getElementById(targetId);
    sel.innerHTML = '<option value="">Select district</option>';
    (districts[div] || []).forEach(d => sel.innerHTML += `<option>${d}</option>`);
  };

  function showError(msg) {
    const el = document.getElementById('errorMsg');
    el.textContent = msg; el.classList.add('show');
    setTimeout(() => el.classList.remove('show'), 4000);
  }
  function showSuccess(msg) {
    const el = document.getElementById('successMsg');
    el.textContent = msg; el.classList.add('show');
  }

  window.signUpEmail = async () => {
    const name = document.getElementById('firstName').value.trim() + ' ' + document.getElementById('lastName').value.trim();
    const email = document.getElementById('emailInput').value.trim();
    const password = document.getElementById('passwordInput').value;
    const blood = document.getElementById('bloodGroup').value;
    const gender = document.getElementById('gender').value;
    const age = parseInt(document.getElementById('age').value) || null;
    const division = document.getElementById('division').value;
    const district = document.getElementById('districtSel').value;
    const city = document.getElementById('cityInput').value.trim();

    if (!name.trim() || !email || !password || !blood || !division || !district) return showError('Please fill all required fields.');
    if (password.length < 8) return showError('Password must be at least 8 characters.');

    try {
      const cred = await createUserWithEmailAndPassword(auth, email, password);
      await sendEmailVerification(cred.user);
      await setDoc(doc(db, 'donors', cred.user.uid), {
        name, email, bloodGroup: blood, gender, age, division, district, city,
        available: true, joinedYear: new Date().getFullYear(),
        createdAt: serverTimestamp(), role: 'donor'
      });
      showSuccess('‚úÖ Account created! Please check your email to verify. If not in your inbox, please check your Spam folder.');
      setTimeout(() => window.location.href = 'donor-dashboard.html', 2500);
    } catch(e) {
      showError(e.message.replace('Firebase: ','').replace(/\(.*\)/,''));
    }
  };
</script>
</body>
</html>
